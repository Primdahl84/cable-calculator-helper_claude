// src/lib/diazed_d2d3d4_100a.ts
// DIAZED D2/D3/D4 100 A â€“ fuld kurve hÃ¥rdkodet
// Kilde: brugerens fil  :contentReference[oaicite:1]{index=1}

export type DiazedPoint = {
  ik: number;
  t: number;
};

export const DIAZED_D2D3D4_100A_POINTS: DiazedPoint[] = [
  { ik: 139.09, t: 7706 },
  { ik: 142.38, t: 6356 },
  { ik: 147.04, t: 5430 },
  { ik: 150.52, t: 4693 },
  { ik: 155.44, t: 3826.2 },
  { ik: 159.58, t: 3012.2 },
  { ik: 163.36, t: 2573.2 },
  { ik: 168.7, t: 2185.4 },
  { ik: 173.71, t: 1813.2 },
  { ik: 178.87, t: 1495.7 },
  { ik: 183.1, t: 1248.2 },
  { ik: 187.44, t: 1035.6 },
  { ik: 191.32, t: 854.3 },
  { ik: 196.42, t: 721.3 },
  { ik: 203.44, t: 619.8 },
  { ik: 208.25, t: 508.3 },
  { ik: 212.56, t: 431.65 },
  { ik: 216.32, t: 384.11 },
  { ik: 220.8, t: 353.99 },
  { ik: 224.71, t: 298.89 },
  { ik: 230.03, t: 265.97 },
  { ik: 235.47, t: 232.57 },
  { ik: 239.64, t: 202.18 },
  { ik: 243.17, t: 177.83 },
  { ik: 248.93, t: 149.27 },
  { ik: 254.83, t: 129.77 },
  { ik: 260.1, t: 115.48 },
  { ik: 266.25, t: 96.37 },
  { ik: 272.56, t: 82.33 },
  { ik: 278.2, t: 71.57 },
  { ik: 285.62, t: 65.96 },
  { ik: 291.53, t: 57 },
  { ik: 301.06, t: 50.14 },
  { ik: 309.09, t: 42.831 },
  { ik: 313.64, t: 40.64 },
  { ik: 319.66, t: 36.695 },
  { ik: 325.32, t: 32.749 },
  { ik: 334, t: 29.228 },
  { ik: 342.41, t: 26.391 },
  { ik: 348.47, t: 23.622 },
  { ik: 357.77, t: 21.454 },
  { ik: 365.17, t: 19.371 },
  { ik: 372.72, t: 17.542 },
  { ik: 379.88, t: 16.072 },
  { ik: 388.3, t: 14.898 },
  { ik: 396.33, t: 14.136 },
  { ik: 404.53, t: 12.47 },
  { ik: 412.9, t: 11.096 },
  { ik: 422.68, t: 10.108 },
  { ik: 432.05, t: 9.047 },
  { ik: 445.53, t: 8.265 },
  { ik: 454.08, t: 7.248 },
  { ik: 470.3, t: 6.228 },
  { ik: 489.96, t: 5.305 },
  { ik: 506.72, t: 4.832 },
  { ik: 517.96, t: 4.1037 },
  { ik: 530.22, t: 3.7598 },
  { ik: 541.98, t: 3.4649 },
  { ik: 553.19, t: 3.1378 },
  { ik: 569.61, t: 2.825 },
  { ik: 583.95, t: 2.5657 },
  { ik: 600.41, t: 2.3032 },
  { ik: 618.23, t: 2.0376 },
  { ik: 630.1, t: 1.8079 },
  { ik: 644.07, t: 1.6808 },
  { ik: 661.25, t: 1.5132 },
  { ik: 677.9, t: 1.3624 },
  { ik: 688.89, t: 1.2628 },
  { ik: 703.14, t: 1.1913 },
  { ik: 715.59, t: 1.0819 },
  { ik: 728.26, t: 1.0356 },
  { ik: 743.33, t: 0.9189 },
  { ik: 763.15, t: 0.8153 },
  { ik: 782.37, t: 0.7383 },
  { ik: 799.72, t: 0.6824 },
  { ik: 828.29, t: 0.6055 },
  { ik: 841.72, t: 0.5564 },
  { ik: 859.1, t: 0.5024 },
  { ik: 871.8, t: 0.4684 },
  { ik: 889.8, t: 0.4342 },
  { ik: 905.6, t: 0.39664 },
  { ik: 924.3, t: 0.37525 },
  { ik: 942.1, t: 0.36234 },
  { ik: 962.9, t: 0.32244 },
  { ik: 987.2, t: 0.28693 },
  { ik: 1012, t: 0.25757 },
  { ik: 1033, t: 0.23599 },
  { ik: 1059, t: 0.21184 },
  { ik: 1080.9, t: 0.1924 },
  { ik: 1095.2, t: 0.18256 },
  { ik: 1119.5, t: 0.16922 },
  { ik: 1139.3, t: 0.15732 },
  { ik: 1162.9, t: 0.14498 },
  { ik: 1183.5, t: 0.13439 },
  { ik: 1204.4, t: 0.12678 },
  { ik: 1225.8, t: 0.11481 },
  { ik: 1251.1, t: 0.10519 },
  { ik: 1284.5, t: 0.09525 },
  { ik: 1313, t: 0.08651 },
  { ik: 1338.2, t: 0.0809 },
  { ik: 1369.9, t: 0.07412 },
  { ik: 1390, t: 0.06751 },
  { ik: 1418.8, t: 0.06061 },
  { ik: 1450.3, t: 0.05488 },
  { ik: 1484.6, t: 0.05043 },
  { ik: 1513.1, t: 0.04688 },
  { ik: 1558, t: 0.04436 },
  { ik: 1581, t: 0.039587 },
  { ik: 1606.6, t: 0.03691 },
  { ik: 1642.2, t: 0.034115 },
  { ik: 1673.8, t: 0.031256 },
  { ik: 1710.9, t: 0.028553 },
  { ik: 1751.4, t: 0.025933 },
  { ik: 1777.2, t: 0.02475 },
  { ik: 1811.3, t: 0.02261 },
  { ik: 1856.9, t: 0.020416 },
  { ik: 1887, t: 0.018869 },
  { ik: 1951.6, t: 0.016791 },
  { ik: 1991.9, t: 0.01552 },
  { ik: 2030.2, t: 0.013891 },
  { ik: 2075.2, t: 0.012802 },
  { ik: 2133.7, t: 0.011358 },
  { ik: 2171.5, t: 0.010346 },
  { ik: 2209.9, t: 0.009675 },
  { ik: 2265.5, t: 0.009073 },
  { ik: 2298.9, t: 0.008265 },
  { ik: 2363.7, t: 0.007441 },
  { ik: 2412.6, t: 0.006857 },
  { ik: 2455.3, t: 0.006264 },
  { ik: 2498.8, t: 0.005841 },
  { ik: 2576.7, t: 0.005305 },
  { ik: 2607, t: 0.004903 },
  { ik: 2668.8, t: 0.004466 },
  { ik: 2731.9, t: 0.0041037 },
];

function interpolateDiazed(points: DiazedPoint[], ik: number): number | null {
  if (ik <= 0 || !Number.isFinite(ik)) return null;

  const sorted = [...points].sort((a, b) => a.ik - b.ik);

  if (ik <= sorted[0].ik) return sorted[0].t;
  if (ik >= sorted[sorted.length - 1].ik) return sorted[sorted.length - 1].t;

  for (let i = 0; i < sorted.length - 1; i++) {
    const p1 = sorted[i];
    const p2 = sorted[i + 1];

    if (ik >= p1.ik && ik <= p2.ik) {
      const logI1 = Math.log10(p1.ik);
      const logI2 = Math.log10(p2.ik);
      const logT1 = Math.log10(p1.t);
      const logT2 = Math.log10(p2.t);
      const logIk = Math.log10(ik);

      const ratio = (logIk - logI1) / (logI2 - logI1);
      const logT  = logT1 + ratio * (logT2 - logT1);

      return 10 ** logT;
    }
  }

  return null;
}

export function getDiazedD2D3D4_100ATripTime(ik: number): number | null {
  return interpolateDiazed(DIAZED_D2D3D4_100A_POINTS, ik);
}
